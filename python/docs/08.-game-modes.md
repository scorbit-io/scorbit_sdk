# Game Modes and State Display

## Introduction

Games of various types will often have different ways of tracking their own state. Whether or not a switch is closed, a mode is ready, a mode starts, a mode is lit, a mode is ended but not completed, etc. Technically, the ball you are currently playing is an example of a state, as is an extra ball, or even what gems you have collected on Avengers.

Since we cannot predict your methodology for maintaining that state, we have made it possible for you to send the Scorbit API any information you like in a string format. We have a number of pre-set categories, such as `MULTIBALL`, `BALL LOCKED, or EXTRA BALL, and` specific modes per game, such as "Penguin mode" or "King Tut x2 bonus" for Batman, etc.

In order to display game modes in a scoreboard, these states must be tracked along with the current state of the game session. We mirror the game state in the API, so you can think of these strings as lamps that we only recognize when they are on.

If you send us a string in one score update only once, we consider it a target, and ScorbitVision, the app, and the game session histograms will consider it a momentary state. If you send us a string across multiple score updates, we consider it a longer state, such as a mode, that starts with the first update and ends with the last update sent with that string. The order of the strings isn't important, except that ScorbitVision and the app will cycle through these messages in the order received during live play.

### Format

The game mode format is as following `<CA><n>{<color>}:<Display text>`.

* `<CA>` - [category](08.-game-modes.md#Categories), necessary
* `<n>` - ball number for the category (where applicable), optional
* `{<color>}` - text display [color](08.-game-modes.md#Colors), optional
* `<Display text>` - text to be displayed on the scoreboard, required. It's advised to keep this as short as possible as there might be cases when several game modes stacked and has to be displayed at once.

Examples: `MB:Multiball`, `NA{blue}:Super Spinner`, `EB1:Extra Ball 1`

### Categories

This is the list of common game modes that have to be used across all games. Usage is always `CATEGORY:Display Text` where (as for scoreboards) `Display Text` will be used. Some categories may have number `<n>` where applicable or omitted if not applicable:

* **`MB:[name]`**

&#x20;_**Multiball**_, example: `MB:Multiball` or `MB:Tiger Saw Multiball`

* **`BL<n>:[name]`**

_**Ball locked**_, example: `BL:Ball Locked`, `BL2:Ball 2 Locked.` This is useful if you have visualizations that track total balls locked prior to a multiball and displays it independently. Scorbit visualizations treat these as sequential modes, so Ball 1 Locked will remain lit until Ball 2 Locked, and so on.

* **`WM:[name]`**

_**Wizard Mode**_, example: `WM:Grand Illusion.`This is useful if you will want to trigger events based on specific types of  modes, but at this time is displayed no differently than other modes on visualizations. Is used primarily for achievements.

* **`EB<n>:[name]`**

_**Extra Ball**_, example: `EB1:Extra Ball`, `EB2:Extra Ball`

* **`BX<n>:[name]`**

_**Bonus Multiplier**_, example: `BX2:Bonus 2X`, `BX4:Bonus 4x`

* **`NA:[name]`**

_**Not Applicable**_, for all the rest of arbitrary game modes which are not fit to the above categories, example: `NA:King Tut x2 bonus`

* **`CP:[name]`**

_**Completed**_, for any completed condition (mode, target, etc.) you want to track throughout the game (usually a requirement for wizard modes), will not be displayed but will be captured in CSV session log, example: `CP:Spirit Cards`, `CP:Metamorphosis`

* **`XX:[name]`**

_**Hide From Session**_ _**Log**_, for any type of mode, will be displayed on visualizations but not be added to CSV session log, example: `XX:Spin#`

* **`ZZ:[name]`**

_**Hide From Clients**_, for any type of mode you want in the CSV session log but not visible on the display, example: `ZZ:Special Achievement`

* **`XY:[name]`**&#x20;

_**Game Status Override**_, replaces the "Game On" during game session visuals with a custom text field when no other modes are active, like "Simulation Active."

### Colors

It's possible to set the desired display color of a game mode using optional parameter `{color}` after the category:

**`MB{orange}:Dinosaur Multiball`**

**`NA{yellow}:Reactor Charging`**

You can also use color for any category type, though it's advised to primarily use color in the `NA` category, as other categories will be mapped to their default colors which will be unified across all games.

The following colors are accepted: **`red orange yellow green blue purple pink`**.

Example: For TNA, there are different states of the Reactor and they can be defined as: `NA{yellow}:Reactor Charging`

### Stacking

If there are several game modes that appear together they will be stacked, separated by semicolons:

```
NA:Penguin mode;NA:King Tut x2 Bonus;NA:Mr. Freeze Award
```

## Providing game modes using serial connection

Normally (without any game mode) the format for the current state is:

```
s,p1score,p2score,p3score,p4score,currentplayer,currentball,n
```

If there is a game mode appears it will be provided in square brackets after currentball:

```
s,p1score,p2score,p3score,p4score,currentplayer,currentball,[game_mode],n
```

Examples:

```
s,15000,-1,-1,-1,1,3,[MB:Multiball],n
```

If there are stacked game mode appears, they will be provided using **semicolon** separator. There has to be no extra spaces:

```
s,15000,-1,-1,-1,1,3,[NA:King Tut x2 bonus;NA:Mr. Freeze timers],n
```

## Providing game modes to the API

Using POST to `/entry` alongside with the scores, current ball, etc., you may use the optional extra field: `game_modes` using double quotes. Example:

```
game_modes="MB:Multiball"
```

If there are several game modes stacked, they are separated by semicolons:

```
game_modes="NA:King Tut x2 bonus;NA:Mr. Freeze timers"
```

**IMPORTANT**: The content must be escaped to conform to `application/x-www-form-urlencoded`.

In this example:

```
P1      P2      P3      P4    Player  Ball      Game Modes
7000	-1	-1	-1	1	3	MB:Multiball;WM:Wizard Mode
```

What is actually sent to the API is as follows:

```
session_uuid=bc24b4bd-6c3f-4f53-8287-be3e0e9d0805&session_sequence=4&session_time=7016&active=true&current_ball=3&current_player=1&game_modes=MB%3aMultiball%3bWM%3aWizard%20Mode&current_p1_score=7000&current_p2_score=-1&current_p3_score=-1&current_p4_score=-1
```
